{% extends 'baseadmin.html.twig' %}
{% block title %}User index
{% endblock %}

{% block body %}

	{#<!-- ======= Breadcrumbs ======= -->
																				<div class="breadcrumbs d-flex align-items-center" style="background-image: url('assets/img/contact-header.jpg');">
																					<div class="container position-relative d-flex flex-column align-items-center">
																				
																						<h2>Contact</h2>
																						<ol>
																							<li><a href="index.html">Home</a></li>
																							<li>Contact</li>
																						</ol>
																				
																					</div>
																				</div><!-- End Breadcrumbs -->#}


	<div class="container-fluid p-0">
		<a href="{{ path('app_user_new') }}">Create new</a>
		<input type="text" id="search" class="form-control" placeholder="Search"><br>
		<a class="btn btn-secondary" href="{{ path('app_user_new') }}">Register</a>
		<h1 class="h3 mb-3">Blank Page</h1>
		<div class="row">
			{% for u in pagination %}
				<div class="card col-5 offset-3 m-1 p-5">

					<div class="card-body row">
						<div class="col-6">
							<img src="{{u.image}}" alt="Admin" class="rounded-circle p-1 bg-primary" width="180" height="180">
						</div>
						<div class="col-6 card-title align-self-center mb-0">
							<h5>{{ u.nom}}</h5>
							<p class="m-0">
								{% if user.roles is defined %}
									<p class="m-0">{{ user.roles ? user.roles|json_encode : '' }}</p>
								{% endif %}
							</p>
						</div>
					</div>
					<ul class="list-group list-group-flush">
						<li class="list-group-item">
							<i class="fa fa-envelope float-right"></i>Email :
							<a href="#">{{ u.email }}</a>
						</li>
						<li class="list-group-item">
							<i class="fa fa-phone float-right"></i>Phone :
							{{ u.numtel }}
						</li>
					</ul>*

					<div class="float-right btn-group btn-group-sm">
						<a href="{{ path('app_user_show', {'id': u.id}) }}" class="btn btn-outline-primary">Profil
							<i class="fa fa-pencil">
								<i class="fa fa-pencil"></i>
							</i>
						</a>


						<a href="{{ path('app_user_edit', {'id': u.id}) }}" class="btn btn-outline-primary">Edit
							<i class="fa fa-pencil">
								<i class="fa fa-pencil"></i>
							</i>
						</a>
						<a href="{{ path('app_user_delete', {'id': u.id}) }}" class="btn btn-outline-primary">Delete
							<i class="fa fa-pencil">
								<i class="fa fa-pencil"></i>
							</i>
						</a>

						<a href="{{ path('app_message_new', {'id': u.id} )}}" class="btn btn-outline-primary">Message
							<i class="fa fa-pencil"></i>
						</a>

					
					</div>
				</div>


			{% endfor %}


			<div class="navigation">
				{{ knp_pagination_render(pagination) }}
			</div>


		</div>
	</div>

	<div>
		<table border="1" id="t" class="table table-hover table-dark">
			<thead class="thead-dark">
				<tr>
					<td>ID</td>
					<td>Email</td>
					<td>password</td>
					<td>Editer</td>
				</tr>
			</thead>
			<tbody id="all">
				{% for u in pagination %}
					<tr>
						<td>
							{{ u.id }}
						</td>
<td>
							{{ u.email }}
						</td>
						<td>
							{{ u.password }}
						</td>
						
						<td>
							<a href="{{ path('app_user_edit', {'id':u.id}) }}">
								modifier</a>
							<a href="{{ path('app_user_delete', {'id':u.id}) }}">
								supprimer</a>
						</td>
					</tr>
				{% endfor %}
			</tbody>
			<tbody id="searchtab">
				<td>ss</td>
			</tbody>
		</table>
	</div>


{% endblock %}
{% block javascripts %}
	{{ parent() }}


	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script>
		$(document).ready(function () {
$("#search").keyup(function () { /* La variable value va prendre la valeur insérer dans le
						champ de texte
						afin d’effectuer la recherche */
var value = $(this).val();
console.log("value : ")
/* Ajax est lancé lors du remplissage du champ texte dont
						l’id est
						« search » pour faire la recherche */
$.ajax({ /* l’url est une chaine de caractères contenant
						l’adresse où la requête est
						6
						envoyée */
url: "{{ path('app_user_search') }}",
/* La méthode utilisée pour transférer les données est
						GET */
type: 'GET',
/*Ici search value va prendre la chaine entrée par un
						utilisateur dans la
						zone de recherche et sera placée après l’url */
data: {
'searchValue': value
},
/*Cette fonction permet de vider le contenu du tableau
						pour recevoir le
						nouveau contenu*/
success: function (retour) {
if (retour) {
$('#t tbody#searchtab').empty();
$.each(JSON.parse(retour), function (i, obj) {
$('#t tbody#all').hide();
$('#t tbody#searchtab').append('<tr><td>' + obj.id + '</td><td>' + obj.email + '</td><td> ' + obj.password + ' </td><td><a href="edit/' + obj.id + '">modifier</a> </br><a	href="deleteStudent/' + obj.id + '">supprimer</a></td></tr>');
});
} else {
$('#t tbody#all').show();
$('#t tbody#searchtab').empty();
$('#t tbody#searchtab').fadeIn('fast');
}
}
});
return false;
});
});
	</script>

{% endblock %}
